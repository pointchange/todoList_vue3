import{nanoid as C}from"https://cdn.jsdelivr.net/npm/nanoid/nanoid.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const i of e)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(e){const i={};return e.integrity&&(i.integrity=e.integrity),e.referrerPolicy&&(i.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?i.credentials="include":e.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(e){if(e.ep)return;e.ep=!0;const i=n(e);fetch(e.href,i)}})();function P(o){return typeof o=="object"&&o!==null}function x(o,t){return o=P(o)?o:Object.create(null),new Proxy(o,{get(n,r,e){return r==="key"?Reflect.get(n,r,e):Reflect.get(n,r,e)||Reflect.get(t,r,e)}})}function z(o,t){return t.reduce((n,r)=>n==null?void 0:n[r],o)}function R(o,t,n){return t.slice(0,-1).reduce((r,e)=>/^(__proto__)$/.test(e)?{}:r[e]=r[e]||{},o)[t[t.length-1]]=n,o}function M(o,t){return t.reduce((n,r)=>{const e=r.split(".");return R(n,e,z(o,e))},{})}function O(o,t){return n=>{var r;try{const{storage:e=localStorage,beforeRestore:i=void 0,afterRestore:c=void 0,serializer:l={serialize:JSON.stringify,deserialize:JSON.parse},key:a=t.$id,paths:f=null,debug:p=!1}=n;return{storage:e,beforeRestore:i,afterRestore:c,serializer:l,key:((r=o.key)!=null?r:h=>h)(typeof a=="string"?a:a(t.$id)),paths:f,debug:p}}catch(e){return n.debug&&console.error("[pinia-plugin-persistedstate]",e),null}}}function L(o,{storage:t,serializer:n,key:r,debug:e}){try{const i=t==null?void 0:t.getItem(r);i&&o.$patch(n==null?void 0:n.deserialize(i))}catch(i){e&&console.error("[pinia-plugin-persistedstate]",i)}}function B(o,{storage:t,serializer:n,key:r,paths:e,debug:i}){try{const c=Array.isArray(e)?M(o,e):o;t.setItem(r,n.serialize(c))}catch(c){i&&console.error("[pinia-plugin-persistedstate]",c)}}function F(o={}){return t=>{const{auto:n=!1}=o,{options:{persist:r=n},store:e,pinia:i}=t;if(!r)return;if(!(e.$id in i.state.value)){const l=i._s.get(e.$id.replace("__hot:",""));l&&Promise.resolve().then(()=>l.$persist());return}const c=(Array.isArray(r)?r.map(l=>x(l,o)):[x(r,o)]).map(O(o,e)).filter(Boolean);e.$persist=()=>{c.forEach(l=>{B(e.$state,l)})},e.$hydrate=({runHooks:l=!0}={})=>{c.forEach(a=>{const{beforeRestore:f,afterRestore:p}=a;l&&(f==null||f(t)),L(e,a),l&&(p==null||p(t))})},c.forEach(l=>{const{beforeRestore:a,afterRestore:f}=l;a==null||a(t),L(e,l),f==null||f(t),e.$subscribe((p,h)=>{B(h,l)},{detached:!0})})}}var K=F();const w=Pinia.defineStore("todoList",{state:()=>({todoList:[{id:"001",context:"vue",isDone:!0,date:"1715443200000"},{id:"002",context:"react",isDone:!1,date:"1715529600000"},{id:"003",context:"angular",isDone:!1,date:"1715616000000"}],toEditing:{id:"",context:"",focus:!1},tip:{title:"",show:!1,color:""}}),getters:{},actions:{addTodoHanler({id:o,context:t,isDone:n,date:r}){this.todoList.unshift({id:o,context:t,isDone:n,date:r}),this.tip={title:"添加成功",show:!0,color:"var(--theme-green)"}},clearDoneHanler(){this.todoList=this.todoList.filter(o=>!o.isDone),this.tip={title:"清除成功",show:!0,color:"var(--theme-red)"}},editTodoHanler(){this.todoList.forEach(o=>{o.id===this.toEditing.id&&(o.context=this.toEditing.context)}),this.tip={title:"编辑成功",show:!0,color:"var(--theme-blue)"}},deleteTodoHanler(){this.todoList=this.todoList.filter(o=>o.id!==this.toEditing.id),this.tip={title:"删除成功",show:!0,color:"var(--theme-red)"}},changeIsDone(o){this.todoList.forEach(t=>{t.id===o&&(t.isDone=!t.isDone,t.isDone?this.tip={title:"好！又完成了一项！为什么要说又？",show:!0,color:"var(--theme-purple)"}:this.tip={title:"没关系！相信你很快会完成的。",show:!0,color:"var(--theme-purple)"})})},checkedAll(o){this.todoList.forEach(t=>{t.isDone=o})}},persist:{key:"todoList",storage:localStorage,path:["todoList"]}}),g=(o,t)=>{const n=o.__vccOpts||o;for(const[r,e]of t)n[r]=e;return n},W={class:"date"},X={__name:"ListItem",props:["id","context","isDone","date","getCoord","editHandler"],setup(o,{expose:t}){const n=o,r=w(),{deleteTodoHanler:e,changeIsDone:i}=r;let c=Vue.computed(function s(){let u=parseInt(Math.random()*50);return u>=10&&u<=20?u:s()}),l=Vue.ref(null),a=Vue.ref({animation:`liAnimation ${c.value}s infinite linear`,top:`${Math.random()*100}%`}),f=Vue.ref(!1),p=Vue.computed(()=>{let u=new Date().getTime()-n.date;if(u<0)return"error";let d=1e3*60,m=d*60,b=m*24,H=b*7,A=b*30,S=u/d,D=u/m,T=u/b,N=u/H,$=u/A;if(u>=0&&u<=d)return"刚刚";if(S>=1&&S<60)return parseInt(S)+"分钟前";if(D>=1&&D<24)return parseInt(D)+"小时前";if(T>=1&&T<7)return parseInt(T)+"天前";if(N>=1&&N<4)return parseInt(N)+"周前";if($>=1&&$<4)return parseInt($)+"月前"}),h=Vue.ref(!1),_=Vue.computed(()=>{if(n.isDone)return{};let{value:s}=p;if(/小时前/.test(s)&&s.match(/\d+/)[0]>1)return{fontSize:"1.2rem"};if(/天前/.test(s)&&s.match(/\d+/)[0]>1)return{fontSize:"2rem"};if(/周前/.test(s)&&s.match(/\d+/)[0]>1)return{fontSize:"4rem"};if(/月前/.test(s)&&s.match(/\d+/)[0]>1)return{fontSize:"5rem"}});function y(){a.value.animation=`liAnimation ${c.value}s infinite linear`,a.value.top=`${Math.random()*100}%`}let V=Vue.ref(0);function E(s){k(),clearTimeout(l.value),l.value=null,l.value=setTimeout(()=>{r.toEditing.focus||(n.getCoord("-10%","50%"),v(),r.toEditing.blur=!1)},4e3),n.getCoord(s.clientX,(s.target===s.currentTarget?s.clientY-s.offsetY:s.clientY-s.offsetY-s.target.offsetTop)+s.currentTarget.offsetHeight,s.currentTarget.offsetWidth),r.toEditing.id=n.id,r.toEditing.context=n.context,V.value++,setTimeout(function(){V.value===2&&(V.value=0,i(n.id))},300),!(s.detail<2)&&i(n.id)}function k(){h.value=!0,f.value=!0,a.value.animationPlayState="paused"}function v(){a.value.animationPlayState="running",f.value=!1,h.value=!1}return t({pausedEffect:k,editBlurEffect:v,id:n.id}),(s,u)=>(Vue.openBlock(),Vue.createElementBlock("li",{style:Vue.normalizeStyle(Vue.unref(a)),class:Vue.normalizeClass({"li-active":Vue.unref(f),"li-Done":o.isDone}),onAnimationiteration:y,onClickCapture:E},[Vue.createElementVNode("div",{class:"context",style:Vue.normalizeStyle(Vue.unref(_))},Vue.toDisplayString(o.context),5),Vue.createElementVNode("div",W,Vue.toDisplayString(Vue.unref(p)),1),Vue.createVNode(Vue.Transition,{name:"delAnimation"},{default:Vue.withCtx(()=>[Vue.unref(h)?(Vue.openBlock(),Vue.createElementBlock("button",{key:0,class:"deleteBtn",onClick:u[0]||(u[0]=Vue.withModifiers((...d)=>Vue.unref(e)&&Vue.unref(e)(...d),["stop"]))}," 删除 ")):Vue.createCommentVNode("",!0)]),_:1})],38))}},Y=g(X,[["__scopeId","data-v-bca6bc05"]]),G={class:"edit-container"},U={__name:"Edit",props:["editHandler"],setup(o){const t=o,n=w(),{toEditing:r}=Pinia.storeToRefs(n),{editTodoHanler:e}=n;function i(){n.toEditing.focus=!1,t.editHandler()}return(c,l)=>(Vue.openBlock(),Vue.createElementBlock("div",G,[Vue.withDirectives(Vue.createElementVNode("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=a=>Vue.unref(r).context=a),onKeyup:l[1]||(l[1]=Vue.withKeys((...a)=>Vue.unref(e)&&Vue.unref(e)(...a),["enter"])),onFocus:l[2]||(l[2]=a=>Vue.unref(n).toEditing.focus=!0),onBlur:i},null,544),[[Vue.vModelText,Vue.unref(r).context]])]))}},J=g(U,[["__scopeId","data-v-303972e7"]]),j=o=>(Vue.pushScopeId("data-v-c598e544"),o=o(),Vue.popScopeId(),o),q={class:"theme-github"},Q=j(()=>Vue.createElementVNode("span",null,[Vue.createElementVNode("a",{href:"https://github.com/pointchange/todoList_vue3"},"GitHub")],-1)),Z={__name:"ThemeGithub",setup(o){let t=Vue.ref(!0),n=Vue.ref("白天");function r(){this.matches?(t.value=!0,n.value="白天",i()):(t.value=!1,n.value="黑夜",i())}Vue.onMounted(()=>{window.matchMedia("(prefers-color-scheme: light)").addEventListener("change",r)}),Vue.onBeforeUnmount(()=>{window.matchMedia("(prefers-color-scheme: light)").removeEventListener("change",r)});function e(l,a){return document.documentElement.style.setProperty(l,a)}function i(){t.value?(n.value="白天",e("--theme-while","#fff"),e("--theme-mdn-bar-color","#f9f9fb"),e("--theme-black","#000"),e("--theme-little-black","#222"),e("--theme-not-like-black","#666"),e("--theme-gray","#ddd")):(n.value="黑夜",e("--theme-while","#1b1b1b"),e("--theme-mdn-bar-color","#333"),e("--theme-black","#ddd"),e("--theme-little-black","#fff"),e("--theme-not-like-black","#999"),e("--theme-gray","#666"))}function c(){console.log("changeTheme"),t.value=!t.value,i()}return(l,a)=>(Vue.openBlock(),Vue.createElementBlock("div",q,[Vue.createElementVNode("span",{onClick:c},Vue.toDisplayString(Vue.unref(n)),1),Q]))}},I=g(Z,[["__scopeId","data-v-c598e544"]]),ee={__name:"Tip",setup(o){const t=w();return(n,r)=>(Vue.openBlock(),Vue.createBlock(Vue.Transition,{name:"tip"},{default:Vue.withCtx(()=>[Vue.withDirectives(Vue.createElementVNode("div",{class:"test",style:Vue.normalizeStyle({color:Vue.unref(t).tip.color,"--theme-var":Vue.unref(t).tip.color}),onAnimationend:r[0]||(r[0]=e=>Vue.unref(t).tip.show=!1)},Vue.toDisplayString(Vue.unref(t).tip.title),37),[[Vue.vShow,Vue.unref(t).tip.show]])]),_:1}))}},te=g(ee,[["__scopeId","data-v-dbafdcd7"]]),oe=o=>(Vue.pushScopeId("data-v-f2804864"),o=o(),Vue.popScopeId(),o),ne={class:"header-first"},re=oe(()=>Vue.createElementVNode("div",{class:"header-left"},[Vue.createTextVNode(" to"),Vue.createElementVNode("div",{class:"header-title"},"do"),Vue.createTextVNode("List ")],-1)),ie={class:"header-add-todo"},le={class:"header-second"},ue={class:"header-second-firstChild"},ae={key:0},se={key:1,class:"empty"},ce={__name:"App",setup(o){const t=w(),{todoList:n}=Pinia.storeToRefs(t),{addTodoHanler:r,clearDoneHanler:e,checkedAll:i}=t,c=Vue.ref(null);let l=Vue.ref({}),a=Vue.ref(""),f=Vue.computed(()=>n.value.length),p=Vue.computed(()=>n.value.reduce((u,d)=>d.isDone?u+1:u,0)),h=Vue.ref({});Vue.onMounted(()=>{l.value.height=`${(1-c.value.clientHeight/window.innerHeight)*100}%`,t.tip.show=!1,f.value?t.$patch({tip:{title:"双击可完成哦",show:!0,color:"var(--theme-deep-purple)"}}):t.$patch({tip:{title:"要做点什么，来！添加一个任务吧",show:!0,color:"var(--theme-deep-purple)"}})});function _(){a.value!=""&&(r({id:C(),context:a.value,isDone:!1,date:new Date().getTime()}),a.value="")}function y(u,d,m){h.value={top:typeof u=="number"?`${d}px`:u,left:typeof u=="number"?`${u}px`:d,width:`${m}px`},u<window.innerWidth*.2?h.value.transform="translateX(0)":window.innerWidth-u<window.innerWidth*.2?h.value.transform="translateX(-100%)":h.value.transform="translateX(-50%)"}const V=Vue.ref(null);function E(){y("-10%","50%"),V.value.forEach(u=>{u.id===t.toEditing.id&&u.editBlurEffect()})}function k(u){i(u.target.checked),u.target.checked?V.value.forEach(d=>{d.pausedEffect()}):V.value.forEach(d=>{d.editBlurEffect()})}let v=Vue.ref(null);function s(){e(),v.value.checked=!1,f.value===0&&(v.value.checked=!1)}return(u,d)=>(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,null,[Vue.createElementVNode("header",{ref_key:"header",ref:c},[Vue.createElementVNode("div",ne,[re,Vue.createElementVNode("div",ie,[Vue.withDirectives(Vue.createElementVNode("input",{type:"text","onUpdate:modelValue":d[0]||(d[0]=m=>Vue.isRef(a)?a.value=m:a=m),onKeyup:Vue.withKeys(_,["enter"])},null,544),[[Vue.vModelText,Vue.unref(a)]]),Vue.createElementVNode("button",{onClick:_},"添加")]),Vue.createVNode(I,{class:"header-right"})]),Vue.createElementVNode("div",le,[Vue.createElementVNode("div",ue,[Vue.createElementVNode("label",null,[Vue.createElementVNode("input",{ref_key:"checkboxElement",ref:v,type:"checkbox",onChange:k},null,544),Vue.createTextVNode(" 全选 ")]),Vue.createElementVNode("span",null," 已完成 "+Vue.toDisplayString(Vue.unref(p))+" / 共 "+Vue.toDisplayString(Vue.unref(f))+" 个 ",1)]),Vue.createVNode(I,{class:"header-second-center"}),Vue.createVNode(te,{class:"Tip"}),Vue.createElementVNode("div",null,[Vue.createElementVNode("button",{onClick:s},"清除已完成")])])],512),Vue.createElementVNode("main",{style:Vue.normalizeStyle(Vue.unref(l))},[Vue.unref(f)?(Vue.openBlock(),Vue.createElementBlock("ul",ae,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(n),m=>(Vue.openBlock(),Vue.createBlock(Y,Vue.mergeProps({getCoord:y,editHandler:E,ref_for:!0,ref_key:"ListItemRef",ref:V,key:m.id},m),null,16))),128))])):(Vue.openBlock(),Vue.createElementBlock("div",se," 空 "))],4),Vue.createVNode(J,{style:Vue.normalizeStyle(Vue.unref(h)),editHandler:E},null,8,["style"])],64))}},de=g(ce,[["__scopeId","data-v-f2804864"]]);Vue.createApp(de).use(Pinia.createPinia().use(K)).mount("#app");
